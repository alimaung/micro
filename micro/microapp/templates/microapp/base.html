{% load i18n %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Microfilm Processing System{% endblock %}</title>
    {% load static %}
    <!-- Favicon -->
    <link rel="icon" href="{% static 'microapp/img/app-logo.png' %}" type="image/png">
    <link rel="shortcut icon" href="{% static 'microapp/img/app-logo.png' %}" type="image/png">
    <link rel="apple-touch-icon" href="{% static 'microapp/img/app-logo.png' %}">
    <meta name="msapplication-TileImage" content="{% static 'microapp/img/app-logo.png' %}">
    <meta name="msapplication-TileColor" content="#1a73e8">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Load our main CSS file -->
    <link rel="stylesheet" href="{% static 'microapp/css/styles.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <!-- Left side - Brand with Logo as a single clickable element -->
        <a href="{% url 'home' %}" class="navbar-brand">
            <img id="logo" src="{% static 'microapp/img/logo-light.png' %}" alt="Micro Logo">
            <span>micro</span>
        </a>
        
        <!-- Middle - Navigation Links -->
        <div class="navbar-links">
            <a href="{% url 'transfer' %}" {% if request.path == '/transfer/' %}class="active"{% endif %}>Transfer</a>
            <a href="{% url 'register' %}" {% if request.path == '/register/' %}class="active"{% endif %}>Register</a>
            <a href="{% url 'film' %}" {% if request.path == '/film/' %}class="active"{% endif %}>Film</a>
            <a href="{% url 'analyze' %}" {% if request.path == '/analyze/' %}class="active"{% endif %}>Analyze</a>
            <a href="{% url 'control' %}" {% if request.path == '/control/' %}class="active"{% endif %}>Control</a>
            <a href="{% url 'develop' %}" {% if request.path == '/develop/' %}class="active"{% endif %}>Develop</a>
            <a href="{% url 'label' %}" {% if request.path == '/label/' %}class="active"{% endif %}>Label</a>
            <a href="{% url 'handoff' %}" {% if request.path == '/handoff/' %}class="active"{% endif %}>Handoff</a>
            <a href="{% url 'explore' %}" {% if request.path == '/explore/' %}class="active"{% endif %}>Explore</a>
            <a href="{% url 'report' %}" {% if request.path == '/report/' %}class="active"{% endif %}>Report</a>
        </div>
        
        <!-- Right side - Icons -->
        <div class="navbar-icons">
            <!-- Language Toggle -->
            <a id="lang-toggle"
                href="{% url 'toggle_language' %}?next={{ request.get_full_path }}"
                title="{% trans 'Toggle language' %}">
                <img
                src="https://flagcdn.com/20x15/{% if LANGUAGE_CODE == 'en' %}us{% elif LANGUAGE_CODE == 'de' %}de{% else %}{{ LANGUAGE_CODE }}{% endif %}.png"
                srcset="https://flagcdn.com/40x30/{% if LANGUAGE_CODE == 'en' %}us{% elif LANGUAGE_CODE == 'de' %}de{% else %}{{ LANGUAGE_CODE }}{% endif %}.png 2x, https://flagcdn.com/60x45/{% if LANGUAGE_CODE == 'en' %}us{% elif LANGUAGE_CODE == 'de' %}de{% else %}{{ LANGUAGE_CODE }}{% endif %}.png 3x"
                width="20"
                height="15"
                alt="{{ LANGUAGE_CODE|upper }}">
            </a>
            <!-- Dark Mode Toggle -->
            <button id="dark-mode-toggle" title="Toggle Dark Mode">
                <i id="dark-mode-icon" class="fas fa-moon"></i>
            </button>
            <!-- Settings Button -->
            <a href="{% url 'settings' %}" title="Settings">
                <i class="fas fa-cog"></i>
            </a>
            {% if request.user.is_authenticated %}
            <a href="{% url 'logout' %}?next={{ request.get_full_path }}" title="Logout">
                <i class="fas fa-sign-out-alt"></i>
            </a>
            {% else %}
            <a href="{% url 'login' %}?next={{ request.get_full_path }}" title="Login">
                <i class="fas fa-user"></i>
            </a>
            {% endif %}
        </div>
    </nav>

    <!-- Content area -->
    <div class="content">
        {% block content %}{% endblock %}
    </div>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-links">
                <div class="footer-column">
                    <h3>
                        {% trans "About Us" %}
                        <i class="fas fa-chevron-down"></i>
                    </h3>
                    <ul>
                        <li><a href="#">{% trans "Documentation" %}</a></li>
                        <li><a href="#">{% trans "System Info" %}</a></li>
                        <li><a href="#">{% trans "Contact" %}</a></li>
                        <li><a href="#">{% trans "Support" %}</a></li>
                        <li><a href="#">{% trans "Updates" %}</a></li>
                        <li><a href="#">{% trans "Release Notes" %}</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>
                        {% trans "Features" %}
                        <i class="fas fa-chevron-down"></i>
                    </h3>
                    <ul>
                        <li><a href="{% url 'transfer' %}">{% trans "Transfer" %}</a></li>
                        <li><a href="{% url 'register' %}">{% trans "Register" %}</a></li>
                        <li><a href="{% url 'film' %}">{% trans "Film" %}</a></li>
                        <li><a href="{% url 'analyze' %}">{% trans "Analyze" %}</a></li>
                        <li><a href="{% url 'control' %}">{% trans "Control" %}</a></li>
                        <li><a href="{% url 'develop' %}">{% trans "Develop" %}</a></li>
                        <li><a href="{% url 'label' %}">{% trans "Label" %}</a></li>
                        <li><a href="{% url 'handoff' %}">{% trans "Handoff" %}</a></li>
                        <li><a href="{% url 'explore' %}">{% trans "Explore" %}</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>
                        {% trans "Tools & Resources" %}
                        <i class="fas fa-chevron-down"></i>
                    </h3>
                    <ul>
                        <li><a href="#">{% trans "API Documentation" %}</a></li>
                        <li><a href="#">{% trans "User Guide" %}</a></li>
                        <li><a href="#">{% trans "Troubleshooting" %}</a></li>
                        <li><a href="#">{% trans "Best Practices" %}</a></li>
                        <li><a href="#">{% trans "Training Materials" %}</a></li>
                        <li><a href="#">{% trans "Community" %}</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>
                        {% trans "System" %}
                        <i class="fas fa-chevron-down"></i>
                    </h3>
                    <ul>
                        <li><a href="{% url 'settings' %}">{% trans "Settings" %}</a></li>
                        <li><a href="#">{% trans "Security" %}</a></li>
                        <li><a href="#">{% trans "Backup" %}</a></li>
                        <li><a href="#">{% trans "Maintenance" %}</a></li>
                        <li><a href="#">{% trans "Monitoring" %}</a></li>
                        <li><a href="#">{% trans "Logs" %}</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-logo">
                    <img src="{% static 'microapp/img/logo-light.png' %}" alt="Micro Logo">
                    <span>micro</span>
                </div>
                
                <div class="footer-legal">
                    <a href="#">{% trans "Privacy Policy" %}</a>
                    <a href="#">{% trans "Terms of Service" %}</a>
                    <a href="#">{% trans "License" %}</a>
                </div>
                
                <div class="footer-extra">
                    <a href="#" class="footer-help">
                        <i class="fas fa-question-circle"></i>
                        {% trans "Help" %}
                    </a>
                    <select class="footer-lang-selector">
                        <option value="en" {% if LANGUAGE_CODE == 'en' %}selected{% endif %}>English</option>
                        <option value="de" {% if LANGUAGE_CODE == 'de' %}selected{% endif %}>Deutsch</option>
                    </select>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- Main JavaScript file -->
    <script src="{% static 'microapp/js/main.js' %}"></script>
    <!-- Footer JavaScript -->
    <script>
        // Footer mobile toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            const footerColumns = document.querySelectorAll('.footer-column h3');
            
            function toggleColumn(column) {
                const parent = column.parentElement;
                parent.classList.toggle('expanded');
            }
            
            footerColumns.forEach(column => {
                column.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        toggleColumn(this);
                    }
                });
            });
            
            // Handle window resize
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    document.querySelectorAll('.footer-column').forEach(col => {
                        col.classList.remove('expanded');
                    });
                }
            });
            
            // Language selector change
            const langSelector = document.querySelector('.footer-lang-selector');
            if (langSelector) {
                langSelector.addEventListener('change', function() {
                    const selectedLang = this.value;
                    // You can implement language switching logic here
                    console.log('Language changed to:', selectedLang);
                });
            }
        });
    </script>
        <script src="{% static 'microapp/js/register/storage-service.js' %}"></script>
    {% block extra_js %}{% endblock %}
  </body>
</html> 